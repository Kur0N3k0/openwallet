<html>
    <head>
        <title>Upbit wallet watchdog</title>
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@500&family=Ubuntu:wght@500&display=swap" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.3/socket.io.js" integrity="sha512-2RDFHqfLZW8IhPRvQYmK9bTLfj/hddxGXQAred2wNZGkrKQkLGj8RCkXfRJPHlDerdHHIzTFaahq4s/P4V6Qig==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    </head>
    <style>
        body {
            background-color: #313235;
            color: white;
            font-family: 'Raleway', sans-serif;
            font-family: 'Ubuntu', sans-serif;
        }
        .currency {
            font-size: 40px;
        }

        #snackbar {
            visibility: hidden;
            min-width: auto0px;
            margin-left: -1autopx;
            background-color: #313235;
            color: #fff;
            text-align: center;
            border-radius: 2px;
            padding: 16px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 30px;
        }

        #snackbar.show {
            visibility: visible;
            
            -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
        }


        @-webkit-keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }

        @keyframes fadein {
            from {bottom: 0; opacity: 0;}
            to {bottom: 30px; opacity: 1;}
        }

        @-webkit-keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }

        @keyframes fadeout {
            from {bottom: 30px; opacity: 1;}
            to {bottom: 0; opacity: 0;}
        }

        .footer {
            position: fixed;
            left: 0;
            bottom: 0;
            width: 100%;
            background-color: #28292d;
            color: white;
            text-align: center;
        }

        .footer > .footer-item {
            display: inline-block;
            padding: 10px;
        }

        .footer > .footer-item:hover {
            background-color: #222;
        }

        .footer > .footer-item > a {
            text-decoration: none;
            padding: 10px;
            color: white;
        }

        .red {
            color: #d60000;
        }
        .blue {
            color: #0051c7;
        }
    </style>
    <body>
        <div class="container h-100">
            <div class="row h-100 justify-content-center align-items-center">
                <div class="col w-25">
                    <h2>OpenWallet</h2>
                </div>
                <div class="col w-50">
                    <div class="row">
                        <div class="input-group input-group-sm mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-sm">Nickname</span>
                            </div>
                            <input type="text" class="form-control" id="nick" aria-label="Nickname" aria-describedby="inputGroup-sizing-sm">
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-group input-group-sm mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-sm">AccessKey</span>
                            </div>
                            <input type="text" class="form-control" id="access_key" aria-label="AccessKey" aria-describedby="inputGroup-sizing-sm">
                        </div>
                    </div>
                    <div class="row">
                        <div class="input-group input-group-sm mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="inputGroup-sizing-sm">SecretKey</span>
                            </div>
                            <input type="text" class="form-control" id="secret_key" aria-label="SecretKey" aria-describedby="inputGroup-sizing-sm">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col text-center">
                            <input type="button" class="btn btn-dark" value="추가하기">
                        </div>
                    </div>
                    <div class="row">
                        <div class="text-center">
                            (*) 주의사항: upbit의 Access key와 Secret key의 권한을 "자산조회"만 설정해주세요.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
    <script>
        $(() => {
            function inputcheck() {
                return $("#nick").val() && $("#access_key").val() && $("#secret_key").val()
            }

            $("input[class=form-control]").keydown(function (key) {
                if(key.keyCode == 13){
                    if(!inputcheck()) {
                        alert("모두 입력해주세요.")
                        return
                    }

                    $.ajax({
                        method: "POST",
                        url: "/setup",
                        contentType: "application/json",
                        dataType: "json",
                        data: JSON.stringify({
                            nick: $("#nick").val(),
                            access_key: $("#access_key").val(),
                            secret_key: $("#secret_key").val()
                        }),
                        success: (data) => {
                            if(data.error) {
                                alert("에러가 발생했습니다.")
                                return
                            }
                            location = "/user/" + $("#nick").val()
                        }
                    })
                }
            })
        })
    </script>
</html>